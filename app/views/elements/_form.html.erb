<%= form_for ([current_user, @element]), url: "/users/#{current_user.id}/elements/#{@element.id}/reviewed", remote: true do |f| %>
<%= link_to "Edit", url_for([:edit, current_user, @element]) %>
<div class="field">
  <%= f.text_area :question, rows: 3, cols: 80  %>
</div>
<span id="show_answer">Show answer</span>
<div class="field">
  <%= f.text_area :answer, value: "", rows: 3, cols: 80 %>
</div>
<div id="grades" class="action" style="visibility: hidden;">
  <%= f.submit "Ideal", class: "input_submit" %>
  <%= f.submit "Good", class: "input_submit" %>
  <%= f.submit "Pass", class: "input_submit" %>
  <%= f.submit "Bad", class: "input_submit" %>
  <%= f.submit "Null", class: "input_submit" %>
</div>
<% end %>

<script>
  $('#element_answer').focus();
  var answer = "<%= @element.answer %>";
  var box = $('#element_answer')
  var once = false;
  $('#show_answer').click(function() {
    box.val(answer);
    if(!once) {
      $('#grades').css('visibility','visible').hide().fadeIn("slow");
    }
  });


  $('#element_answer').keyup(function() {
    if(box.val().length == answer.length && !once) {
      once = true;
      $('#grades').css('visibility','visible').hide().fadeIn("slow");
    }
  });

  $('#element_answer').keydown(function(event) {
    if(event.keyCode == 8) {
      box.val(answer.substring(0, box.val().length+1));  
    }
    else {
      key =  String.fromCharCode(event.keyCode).toLowerCase();
      char_answer = answer.substring(box.val().length, box.val().length+1).toLowerCase();
      if(key == char_answer) {
        box.val(box.val() + answer.substring(box.val().length, box.val().length+1));
      }
    }
    return false;
  });
</script>
